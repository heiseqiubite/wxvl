#  自动化平台n8n曝高危漏洞CVE-2026-21858，10万服务器面临接管风险  
看雪学苑  看雪学苑   2026-01-08 10:05  
  
近日，流行工作流自动化平台n8n曝出一个严重安全漏洞（CVE-2026-21858），威胁着全球约10万台服务器。该漏洞允许未经身份验证的攻击者完全控制服务器，其CVSS评分高达10.0，属于最高危级别。更令人担忧的是，完整的攻击链概念验证（PoC）已在网上公开。  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/1UG7KPNHN8HmiaHUKWmXHbcGCyfKtYLEBicjn0icRyJhm6MGgiaWBgQ1hLicnobvmaO7EAuRC86JYBveVnpvo2JDExA/640?wx_fmt=png&from=appmsg "")  
  
  
根据安全公司Cyera发布的报告，该漏洞源于n8n处理HTTP请求时存在一个“Content-Type混淆”的逻辑错误。平台在处理传入数据时，若请求头为`multipart/form-data`，会使用安全的文件解析器（Formidable）填充`req.body.files`；若为`application/json`，则会用标准解析器解析JSON载荷至`req.body`。  
  
  
关键在于，用于处理文件上传的“表单Webhook节点”中的`prepareFormReturnItem`函数，盲目信任`req.body.files`的内容，却未验证请求是否确实为`multipart/form-data`类型。这导致攻击者可以进行一个致命操作：  
  
  
发送一个`Content-Type`标头为`application/json`的请求，但在JSON正文中恶意构造一个`files`对象，并指定`filepath`参数指向服务器上的任意文件（例如`/etc/passwd`）。由于程序信任此输入，便会将服务器内部文件“复制”并返回给攻击者，从而实现任意文件读取。  
  
  
然而，危险不止于此。Cyera报告详细描述了如何将此漏洞武器化，逐步实现完整的服务器接管：  
- 第一步：窃取凭据。  
攻击者利用文件读取漏洞，获取n8n数据库（如`/home/node/.n8n/database.sqlite`）和配置文件（`/home/node/.n8n/config`）。  
  
- 第二步：伪造会话。  
数据库中存有用户详情（邮箱和哈希密码），配置文件则包含加密密钥。结合这两者，攻击者可以数字签名自己的会话Cookie（`n8n-auth`），从而以管理员身份成功登录系统。  
  
- 第三步：执行代码。  
一旦获得管理员权限，攻击者只需创建一个新工作流，添加“执行命令”节点，便可运行任意shell命令，完全掌控服务器。  
  
安全研究员Chocapikk已公开了一个PoC，将该漏洞与另一个漏洞（CVE-2025-68613）串联，实现了未经身份验证的远程代码执行（RCE）。  
  
  
此次漏洞的“爆炸半径”极大。由于n8n被设计用于连接各类系统，一个被攻陷的实例相当于将攻击者引入了它所触及的所有关键资产：“企业的Google Drive、OpenAI API密钥、Salesforce数据、IAM系统、支付处理器”等等。  
  
  
目前，官方并未提供针对此漏洞的临时缓解措施。管理员必须立即将n8n升级至1.121.0或更高版本以修复此问题。同时，安全团队应确保除非绝对必要，否则不要将n8n实例暴露在公网，并确保所有表单功能都已启用强制身份验证。  
  
  
  
资讯来源  
：  
cybersecuritynews  
  
转载请注明出处和本文链接  
  
  
  
﹀  
  
﹀  
  
﹀  
  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/Uia4617poZXP96fGaMPXib13V1bJ52yHq9ycD9Zv3WhiaRb2rKV6wghrNa4VyFR2wibBVNfZt3M5IuUiauQGHvxhQrA/640?wx_fmt=jpeg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_gif/1UG7KPNHN8Fjcl6q2ORwibt8PXPU5bLibE1yC1VFg5b1Fw8RncvZh2CWWiazpL6gPXp0lXED2x1ODLVNicsagibuxRw/640?wx_fmt=gif&from=appmsg "")  
  
**球分享**  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_gif/1UG7KPNHN8Fjcl6q2ORwibt8PXPU5bLibE1yC1VFg5b1Fw8RncvZh2CWWiazpL6gPXp0lXED2x1ODLVNicsagibuxRw/640?wx_fmt=gif&from=appmsg "")  
  
**球点赞**  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_gif/1UG7KPNHN8Fjcl6q2ORwibt8PXPU5bLibE1yC1VFg5b1Fw8RncvZh2CWWiazpL6gPXp0lXED2x1ODLVNicsagibuxRw/640?wx_fmt=gif&from=appmsg "")  
  
**球在看**  
  
