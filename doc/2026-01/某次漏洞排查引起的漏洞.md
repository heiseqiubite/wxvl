#  某次漏洞排查引起的漏洞  
原创 进击的HACK  进击的HACK   2026-01-07 23:50  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/DuibU3GqmxVmRsdItbBVRKegNHicHQvAHDdZsGpLVU7touSU1AU1twHTfRjG3Vu5aUh0RnPPllfVUhs4qdWF5QYQ/640?wx_fmt=png&wxfrom=13 "")  
  
声明：  
文中所涉及的技术、思路和工具仅供以安全为目的的学习交流使用，任何人不得将其用于非法用途给予盈利等目的，否则后果自行承担！  
如有侵权烦请告知，我会立即删除并致歉。谢谢  
！  
  
文章有疑问的，可以公众号发消息问我，或者留言。我每天都会看的。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/9zYJrD2VibHmqgf4y9Bqh9nDynW5fHvgbgkSGAfRboFPuCGjVoC3qMl6wlFucsx3Y3jt4gibQgZ6LxpoozE0Tdow/640?wx_fmt=png&wxfrom=13 "")  
  
  
  
   
  
> 字数 784，阅读大约需 4 分钟  
  
## 前言  
  
最近，领导在公司群里转发了一篇文章。  
[476万损失背后的平台漏洞：17岁少年诈骗获刑，电商业务漏洞安全敲响警钟](https://mp.weixin.qq.com/s?__biz=Mzk0ODY1NzEwMA==&mid=2247493163&idx=1&sn=5b355eb4cd9379815337bde16fc6cc43&click_id=9&scene=21#wechat_redirect)  
  
  
并 @我 ，让我梳理相关信息，对公司涉及到相关业务的资产进行排查。  
  
正在摸鱼的我：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/a1BOUvqnbrj7LrsicB0V2LrlrbGynI12GDcjuU01Mn5HVFua4koW3Md2OqTwlo76icsQuBgbzlIGv9SeQtUiceLaw/640?wx_fmt=png&from=appmsg "")  
  
## 梳理  
  
新闻来源：https://www.bilibili.com/video/BV1FtSvBREUp  
  
简单来说，某平台可以在未退货的情况下直接退款。  
  
有人说，这不就是“仅退款”吗？  
  
不，“仅退款”实现的前提是平台给出了相关的按钮、提供了相关的功能，属于平台允许的操作。  
  
在该案例中，攻击者并非通过正常的仅退款流程，而是发现在“用户退货，平台退款”的流程有问题。  
  
![6c8a91e6db993cc6cfb7239c14b0c605.png](https://mmbiz.qpic.cn/sz_mmbiz_png/a1BOUvqnbrj7LrsicB0V2LrlrbGynI12Gs0nsX9SmbMDJOcHAAdbP8d9JSicmNYthKUgLxXmoQ4qKpPxvXX78Xug/640?from=appmsg "null")  
  
6c8a91e6db993cc6cfb7239c14b0c605.png  
  
新闻后续又提到  
  
![8e15d12a5d07f0b666d595ec03de58be.png](https://mmbiz.qpic.cn/sz_mmbiz_png/a1BOUvqnbrj7LrsicB0V2LrlrbGynI12GkBm2VgiaZutTx02iaWaowgleT13rjrDue3LD0RO7NIszb3qnqwTIiarsQ/640?from=appmsg "null")  
  
8e15d12a5d07f0b666d595ec03de58be.png  
  
那就有了一个简单的猜测：  
  
![f8265c578039e96de392b29f906e3244.png](https://mmbiz.qpic.cn/sz_mmbiz_png/a1BOUvqnbrj7LrsicB0V2LrlrbGynI12Gbzl0Zns4cKQzZibYr7TfEEVricXK5GLNpRghX551bPhFZ1mnMHm7NiaOA/640?from=appmsg "null")  
  
f8265c578039e96de392b29f906e3244.png  
  
在**填写退货快递单号**  
这一步骤中，平台未校验退货快递单号的真实性。  
## 测试  
  
获取资产比较简单，之前对公司资产进行过梳理，涉及到金钱业务的算是公司核心业务了，联系几个部门要 UAT 环境和测试账号来测试。  
  
只是，在测试的时候遇到了不少意料之外的问题。  
  
因为涉及到金钱，UAT 环境在退货退款这一块是直接模拟的。查看物流功能更是直接报错，因为物流一般是调用的第三方接口查看的，模拟的物流 ID 自然查不到。  
  
我把情况反馈给领导：“X 总啊，UAT 环境不支持啊，您看怎么做？”  
  
我眨巴眨巴眼睛，期待听到那句“那算了”。  
  
但是 X 总到底是 X 总，语不惊人死不休。  
  
“要不用生产测吧。”  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/a1BOUvqnbrj7LrsicB0V2LrlrbGynI12GcAEib2AW0tCj3M59w7aC9IWnxlbXwaQsVjeOnwaiaCoFL9uoD9ibZncrA/640?wx_fmt=png&from=appmsg "")  
  
  
我登时有一种林冲误入白虎堂的感觉。领导不会是想开了我吧。直接拿生产，要是出了点事，是不是要拿人头来见了。  
  
领导：你之前不是还挖过公司的漏洞吗，你那时候怎么不怕？  
  
那能一样吗？！  
  
好吧，既然领导发话了，也是拿到授权了。我也是久违的登上了我的账号，抓包测试。  
  
好消息，退货退款功能没问题。  
  
坏消息，我发现之前发现的漏洞，在公司新版本里还在。开发在之前某一版本里修复了，UAT 环境还是我测的。  
  
![fb91da498ddfec6891d1003be28b7cd7.png](https://mmbiz.qpic.cn/sz_mmbiz_png/a1BOUvqnbrj7LrsicB0V2LrlrbGynI12G4ib2IVl1Tib3OicsKwFjb8hvfFrq1L5sEApwPRGozZCyCgO4PBIEefVdQ/640?from=appmsg "null")  
  
fb91da498ddfec6891d1003be28b7cd7.png  
  
领导把 APP 的项目经理以及开发拉来，组了个会聊了一下。  
  
开发看了看：“应该是组里某个开发代码没更新，git push 的时候把旧代码覆盖上去了。”  
## 总结  
  
及时更新自己本地的代码，以及别用  
```
git push --force origin <branch-name>
```  
  
不然，可能会被领导和同事打死。  
  
如果针对一个系统进行持续性的渗透测试、漏洞修复环节，就会发现，在某个版本已修复的漏洞，在新版本里会继续冒出来。  
  
开发团队，统一规范，刻不容缓啊。  
  
   
  
  
  
欢迎加入知识星球，星球内容主要有：  
  
1、公众号文章备份、工具分享。  
  
2、常见问题的答疑、解决方案汇总在知识星球，作为便于搜索的知识库。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/a1BOUvqnbriac4rcXic5DYPcicY8wjnZribzlTicb8LYBx4m54uoUx7eUbvaa04H7pa8MulbaZdlcEYEMRN0NwQ41bw/640?wx_fmt=jpeg "")  
  
  
  
