#  【附POC及复现环境】n8n双CVE漏洞利用链可致远程代码执行漏洞（CVE-2026-21858+CVE-2025-68613）  
原创 a1batr0ss  天翁安全   2026-01-08 09:45  
  
**免责声明：**  
本公众号所发布的全部内容，包括但不限于技术文章、POC脚本、漏洞利用工具及相关测试环境，均仅限于合法的网络安全学习、研究和教学用途。所有人在使用上述内容时，应严格遵守中华人民共和国相关法律法规以及道德伦理要求。未经明确的官方书面授权，严禁将公众号内的任何内容用于未经授权的渗透测试、漏洞利用或攻击行为。 所有人仅可在自己合法拥有或管理的系统环境中进行本地漏洞复现与安全测试，或用于具有明确授权的合法渗透测试项目。所有人不得以任何形式利用公众号内提供的内容从事非法、侵权或其他不当活动。 如因违反上述规定或不当使用本公众号提供的任何内容，造成的一切法律责任、经济损失、纠纷及其他任何形式的不利后果，均由相关成员自行承担，与本公众号无任何关联。  
## 不错过最新的漏洞POC  
  
为保证您可以在第一时间接收到本公众号分享的**漏洞复现及POC**  
信息，建议您在公众号“天翁安全”主页界面将“天翁安全”设为**星标**  
。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S64HydAbWYtcLlXr5aeHd9o9tFuJFPucFheLXFLfrfbpkALVHJSSDo9grVbClGaT3QtW9lvWxHbAw/640?wx_fmt=png&from=appmsg "")  
  
## 漏洞介绍  
  
n8n 是一款开源的工作流自动化与集成平台，主打可自托管和高度可定制的自动化能力，允许用户通过可视化节点和表达式将不同的应用、服务和内部系统连接起来，广泛用于 DevOps、数据同步、告警处理和业务流程自动化等场景；凭借对隐私友好的自部署模式、活跃的开源社区以及对数百种第三方服务的原生支持，n8n 在开发者和中小企业中具有较高影响力，已被大量公司用于生产环境，其工作流引擎往往直接接触内部系统、凭据和敏感数据，因此一旦出现安全漏洞，往往具有较大的实际风险和安全影响。  
  
**CVE-2026-21858 与 CVE-2025-68613 可以组合形成一条完整的远程代码执行漏洞利用链**  
，其核心逻辑是“信息泄露导致信任边界崩塌，进而触发高权限代码执行漏洞”：攻击者首先利用 CVE-2026-21858 在未认证的情况下读取 n8n 服务器上的任意文件，从中获取配置文件、数据库内容或加密密钥等敏感信息，并据此伪造合法的管理员身份或会话；在成功冒充管理员后，攻击者即可访问 n8n 中仅对高权限用户开放的工作流和表达式功能，进一步利用 CVE-2025-68613 中表达式沙箱隔离不足的问题实现沙箱逃逸，最终在服务器上执行任意系统命令，从而将原本看似独立的文件读取和逻辑漏洞串联为一条高危的未授权 RCE 攻击链。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/I2eHcAFia5S64HydAbWYtcLlXr5aeHd9orPfMwuSnichESEMaIMbncn4LZyicEcW72XmaeKynVQibootPwR5pnH5Hw/640?wx_fmt=other&from=appmsg "")  
## 漏洞影响版本  
  
**CVE-2026-21858：**  
<table><thead><tr style="box-sizing: border-box;"><th style="box-sizing: border-box;margin: 0px;padding: 0.5rem 1rem;font-style: normal;font-weight: bold;text-align: left;border: 1px solid rgb(233, 235, 236);"><section><span leaf="">产品版本</span></section></th><th style="box-sizing: border-box;margin: 0px;padding: 0.5rem 1rem;font-style: normal;font-weight: bold;text-align: left;border: 1px solid rgb(233, 235, 236);"><section><span leaf="">版本</span></section></th></tr></thead><tbody><tr style="box-sizing: border-box;"><td style="box-sizing: border-box;margin: 0px;padding: 0.5rem 1rem;border: 1px solid rgb(233, 235, 236);"><section><span leaf="">n8n</span></section></td><td style="box-sizing: border-box;margin: 0px;padding: 0.5rem 1rem;border: 1px solid rgb(233, 235, 236);"><section><span leaf="">1.65.0 ≤ 版本 &lt; 1.121.0</span></section></td></tr></tbody></table>  
**CVE-2025-68613：**  
<table><thead><tr style="box-sizing: border-box;"><th style="box-sizing: border-box;margin: 0px;padding: 0.5rem 1rem;font-style: normal;font-weight: bold;text-align: left;border: 1px solid rgb(233, 235, 236);"><section><span leaf="">产品版本</span></section></th><th style="box-sizing: border-box;margin: 0px;padding: 0.5rem 1rem;font-style: normal;font-weight: bold;text-align: left;border: 1px solid rgb(233, 235, 236);"><section><span leaf="">版本</span></section></th></tr></thead><tbody><tr style="box-sizing: border-box;"><td style="box-sizing: border-box;margin: 0px;padding: 0.5rem 1rem;border: 1px solid rgb(233, 235, 236);"><section><span leaf="">n8n 1.120.x</span></section></td><td style="box-sizing: border-box;margin: 0px;padding: 0.5rem 1rem;border: 1px solid rgb(233, 235, 236);"><section><span leaf="">0.211.0 ≤ 版本 &lt; 1.120.4</span></section></td></tr><tr style="box-sizing: border-box;background-color: rgb(248, 248, 248);"><td style="box-sizing: border-box;margin: 0px;padding: 0.5rem 1rem;border: 1px solid rgb(233, 235, 236);"><section><span leaf="">n8n 1.121.x</span></section></td><td style="box-sizing: border-box;margin: 0px;padding: 0.5rem 1rem;border: 1px solid rgb(233, 235, 236);"><section><span leaf="">0.211.0 ≤ 版本 &lt; 1.121.1</span></section></td></tr><tr style="box-sizing: border-box;"><td style="box-sizing: border-box;margin: 0px;padding: 0.5rem 1rem;border: 1px solid rgb(233, 235, 236);"><section><span leaf="">n8n 1.122.x</span></section></td><td style="box-sizing: border-box;margin: 0px;padding: 0.5rem 1rem;border: 1px solid rgb(233, 235, 236);"><section><span leaf="">0.211.0 ≤ 版本 &lt; 1.122.0</span></section></td></tr></tbody></table>## 环境部署  
  
在“n8n双CVE漏洞利用链复现环境” 中的执行以下命令部署漏洞复现环境  
> “n8n双CVE漏洞利用链复现环境”详见文末  
  
```
docker-compose up -d
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S64HydAbWYtcLlXr5aeHd9oia5zdMlaDrwzs0sELbpGVWR9q0YUzPsE3nuwicEwCxIK33icHIuTSxR0g/640?wx_fmt=png&from=appmsg "")  
  
部署成功后访问 http://localhost:5678/  
可可看到如下界面  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S64HydAbWYtcLlXr5aeHd9oR7hErd2V8cMm5fIFSbFubGrVgGEfRvrQSaFicafWeacTIyDfauw70rQ/640?wx_fmt=png&from=appmsg "")  
## 漏洞复现  
> “n8n任意代码执行漏洞利用链POC”详见文末  
  
  
执行以下Python脚本：利用**CVE-2026-21858+CVE-2025-68613**  
漏洞利用链执行任意命令（这里执行id命令）  
```
python n8n任意代码执行漏洞利用链POC.py http://localhost:5678 /form/vulnerable-form --cmd id
```  
  
执行Python脚本后会自动运行四个阶段**（任意文件读取 → 令牌伪造 → 沙箱绕过 → 执行命令）**  
  
**第一阶段：任意文件读取**  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S64HydAbWYtcLlXr5aeHd9oz5uiccWob0xu9pta7IvPnNHG05BrBphkejVfibKsicTm1u34YIoia5juOA/640?wx_fmt=png&from=appmsg "")  
  
**第二阶段：令牌伪造**  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S64HydAbWYtcLlXr5aeHd9oJ781Co7BJhOibEVWMZmESuF44g93OSV2dhUTeZfbKkhxwYZexbTpnUA/640?wx_fmt=png&from=appmsg "")  
  
**第三阶段：沙箱绕过**  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S64HydAbWYtcLlXr5aeHd9ok1RBXS2tHs0Rvh36RtscCTJSNibHXyzqocrDTeOwwORE8TqtD18ac2A/640?wx_fmt=png&from=appmsg "")  
  
**第四阶段：执行命令**  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S64HydAbWYtcLlXr5aeHd9oG98c5QgpPP25vkDYicxpibNcUF5MAX3P7dLlBy2YKGiaWibGT72wkm5iaSg/640?wx_fmt=png&from=appmsg "")  
## 漏洞修复  
  
目前n8n官方已发布新版本，建议用户立刻更新到**1.121.0及以上版本**  
。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S64HydAbWYtcLlXr5aeHd9oGiaYZZq2bj6ra68M14ibwZyRZbDicEJzp1qWjTiaZOPribicXqFZIsDicDrPA/640?wx_fmt=png&from=appmsg "")  
## 知识星球  
  
**“n8n任意代码执行漏洞利用链POC”、“n8n双CVE漏洞利用链复现环境”、“n8n远程代码执行漏洞复现”**  
现已全部发布至知识星球，大家可在知识星球内获取，自行学习复现。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S64HydAbWYtcLlXr5aeHd9obTIlQJ4H7KHkMB5Ph9c98ibNBxwGxPxsR3nR2L1ZibpwwxGSs2KcDuag/640?wx_fmt=png&from=appmsg "")  
> 星球加入方式见文章底部二维码，欢迎加入交流和学习  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S64HydAbWYtcLlXr5aeHd9oGAlS3cmho7tZZ5zccThnoozEkzTPj0KGxuGeSwiaxK76WIJ86Jj6I4w/640?wx_fmt=png&from=appmsg "")  
  
  
